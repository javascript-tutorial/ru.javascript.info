# –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤: onload –∏ onerror

<<<<<<< HEAD
–ë—Ä–∞—É–∑–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤: —Å–∫—Ä–∏–ø—Ç–æ–≤, –∏—Ñ—Ä–µ–π–º–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –¥—Ä.
=======
The browser allows us to track the loading of external resources -- scripts, iframes, pictures and so on.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–î–ª—è —ç—Ç–æ–≥–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ —Å–æ–±—ã—Ç–∏—è:

- `load` -- —É—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞,
- `error` -- –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.

## –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤

–î–æ–ø—É—Å—Ç–∏–º, –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –∏ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤ —ç—Ç–æ–º —Å–∫—Ä–∏–ø—Ç–µ.

–ú—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏:

```js
let script = document.createElement('script');
script.src = "my.js";

document.head.append(script);
```

...–ù–æ –∫–∞–∫ –Ω–∞–º –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤–Ω—É—Ç—Ä–∏ —Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞? –ù–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –º—ã –º–æ–∂–µ–º –µ—ë –≤—ã–∑–≤–∞—Ç—å.

```smart
–î–ª—è –Ω–∞—à–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [JavaScript-–º–æ–¥—É–ª–∏](info:modules), –Ω–æ –æ–Ω–∏ –Ω–µ —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö.
```

### script.onload

–ì–ª–∞–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ - —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ `load`. –û–Ω–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```js run untrusted
let script = document.createElement('script');

// –º—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª—é–±–æ–π —Å–∫—Ä–∏–ø—Ç —Å –ª—é–±–æ–≥–æ –¥–æ–º–µ–Ω–∞
script.src = "https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js"
document.head.append(script);

*!*
script.onload = function() {
<<<<<<< HEAD
  // –≤ —Å–∫—Ä–∏–ø—Ç–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å –∏–º–µ–Ω–µ–º "_"
  alert(_); // —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
=======
  // the script creates a variable "_"
  alert( _.VERSION ); // shows library version
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602
};
*/!*
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ `onload` –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç.–¥., –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Å–∫—Ä–∏–ø—Ç.

<<<<<<< HEAD
...–ê —á—Ç–æ –µ—Å–ª–∏ –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞? –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ—Ç (–æ—à–∏–±–∫–∞ 404), –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

### script.onerror

–û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞, –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Å–ª–µ–∂–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é —Å–æ–±—ã—Ç–∏—è `error`.
=======
...And what if the loading failed? For instance, there's no such script (error 404) or the server is down (unavailable).

### script.onerror

Errors that occur during the loading of the script can be tracked in an `error` event.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å–∏–º —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:

```js run
let script = document.createElement('script');
script.src = "https://example.com/404.js"; // —Ç–∞–∫–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
document.head.append(script);

*!*
script.onerror = function() {
  alert("Error loading " + this.src); // –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ https://example.com/404.js
};
*/!*
```

<<<<<<< HEAD
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ HTTP-–æ—à–∏–±–∫–∏. –ú—ã –Ω–µ –∑–Ω–∞–µ–º, –±—ã–ª–∞ –ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞ 404 –∏–ª–∏ 500, –∏–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –¥—Ä—É–≥–∞—è. –ó–Ω–∞–µ–º —Ç–æ–ª—å–∫–æ, —á—Ç–æ –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.
=======
Please note that we can't get HTTP error details here. We don't know if it was an error 404 or 500 or something else. Just that the loading failed.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

```warn
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `onload`/`onerror` –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å–∞–º –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏.

<<<<<<< HEAD
–û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –∏–º–∏ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è. –ß—Ç–æ–±—ã "–ø–æ–π–º–∞—Ç—å" –æ—à–∏–±–∫–∏ –≤ —Å–∫—Ä–∏–ø—Ç–µ, –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º `window.onerror`.
=======
Errors that may occur during script processing and execution are out of scope for these events. That is: if a script loaded successfully, then `onload` triggers, even if it has programming errors in it. To track script errors, one can use `window.onerror` global handler.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602
```

## –î—Ä—É–≥–∏–µ —Ä–µ—Å—É—Ä—Å—ã

–°–æ–±—ã—Ç–∏—è `load` –∏ `error` —Ç–∞–∫–∂–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, –∞ –≤–æ–æ–±—â–µ, –¥–ª—è –ª—é–±—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –≤–Ω–µ—à–Ω–∏–π `src`.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```js run
let img = document.createElement('img');
img.src = "https://js.cx/clipart/train.gif"; // (*)

img.onload = function() {
  alert(`–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ, —Ä–∞–∑–º–µ—Ä—ã ${img.width}x${img.height}`);
};

img.onerror = function() {
  alert("–û—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è");
};
```

–û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

<<<<<<< HEAD
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç. –ó–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ–≥–∞ `<img>`. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—É—á–∞—é—Ç `src (*)`.
- –î–ª—è `<iframe>` —Å–æ–±—ã—Ç–∏–µ `load` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∫ –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞, —Ç–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.
=======
- Most resources start loading when they are added to the document. But `<img>` is an exception. It starts loading when it gets a src `(*)`.
- For `<iframe>`, the `iframe.onload` event triggers when the iframe loading finished, both for successful load and in case of an error.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–¢–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–ª–æ–∂–∏–ª–æ—Å—å –ø–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –ø—Ä–∏—á–∏–Ω–∞–º.

## –û—à–∏–±–∫–∞ –≤ —Å–∫—Ä–∏–ø—Ç–µ —Å –¥—Ä—É–≥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

–ï—Å—Ç—å –ø—Ä–∞–≤–∏–ª–æ: —Å–∫—Ä–∏–ø—Ç—ã —Å –æ–¥–Ω–æ–≥–æ —Å–∞–π—Ç–∞ –Ω–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –¥—Ä—É–≥–æ–≥–æ —Å–∞–π—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∫—Ä–∏–ø—Ç —Å `https://facebook.com` –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ—á—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ `https://gmail.com`.

<<<<<<< HEAD
–ò–ª–∏, –µ—Å–ª–∏ –±—ã—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º, –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ (–¥–æ–º–µ–Ω/–ø–æ—Ä—Ç/–ø—Ä–æ—Ç–æ–∫–æ–ª) –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Å –¥—Ä—É–≥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞. –î–∞–∂–µ –ø–æ–¥–¥–æ–º–µ–Ω –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏, –Ω–µ –∏–º–µ—é—â–∏–º–∏ –¥–æ—Å—Ç—É–ø–∞ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.
=======
Or, to be more precise, one origin (domain/port/protocol triplet) can't access the content from another one. So even if we have a subdomain, or just another port, these are different origins with no access to each other.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–≠—Ç–æ –ø—Ä–∞–≤–∏–ª–æ —Ç–∞–∫–∂–µ –∫–∞—Å–∞–µ—Ç—Å—è —Ä–µ—Å—É—Ä—Å–æ–≤ —Å –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–æ–≤.

–ï—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫—Ä–∏–ø—Ç —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞, –∏ –≤ –Ω–µ–º –∏–º–µ–µ—Ç—Å—è –æ—à–∏–±–∫–∞, –º—ã –Ω–µ —Å–º–æ–∂–µ–º —É–∑–Ω–∞—Ç—å –¥–µ—Ç–∞–ª–∏ —ç—Ç–æ–π –æ—à–∏–±–∫–∏.

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–≤–∞–π—Ç–µ –≤–æ–∑—å–º—ë–º –º–∏–Ω–∏-—Å–∫—Ä–∏–ø—Ç `error.js`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ-–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
```js
// üìÅ error.js
noSuchFunction();
```

–¢–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∑–∏–º —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å —Ç–æ–≥–æ –∂–µ —Å–∞–π—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω –ª–µ–∂–∏—Ç:

```html run height=0
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script src="/article/onload-onerror/crossorigin/error.js"></script>
```

–ú—ã –≤–∏–¥–∏–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± –æ—à–∏–±–∫–µ:

```
Uncaught ReferenceError: noSuchFunction is not defined
https://javascript.info/article/onload-onerror/crossorigin/error.js, 1:1
```

–ê —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∑–∏–º —ç—Ç–æ—Ç –∂–µ —Å–∫—Ä–∏–ø—Ç —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞:

```html run height=0
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```

–û—Ç—á—ë—Ç –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è:

```
Script error.
, 0:0
```

<<<<<<< HEAD
–î–µ—Ç–∞–ª–∏ –æ—Ç—á—ë—Ç–∞ –º–æ–≥—É—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π: –ª—é–±–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Å–∫—Ä–∏–ø—Ç–∞, –≤–∫–ª—é—á–∞—è —Å—Ç–µ–∫ –æ—à–∏–±–∫–∏, —Å–ø—Ä—è—Ç–∞–Ω–∞. –ò–º–µ–Ω–Ω–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞.
=======
Details may vary depending on the browser, but the idea is the same: any information about the internals of a script, including error stack traces, is hidden. Exactly because it's from another domain.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–ó–∞—á–µ–º –Ω–∞–º –º–æ–≥—É—Ç –±—ã—Ç—å –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏?

<<<<<<< HEAD
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–æ–≤ (–∏ –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –Ω–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π), –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ `window.onerror`, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ—Ç—á—ë—Ç –æ –Ω–∏—Ö –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É –æ—Ç—á—ë—Ç—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –≠—Ç–æ –∑–¥–æ—Ä–æ–≤–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª—É—á–∏–ª–∏—Å—å —É –Ω–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ù–æ –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç - —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞, —Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö –≤ –Ω—ë–º –ø–æ—á—Ç–∏ –Ω–µ—Ç, –∫–∞–∫ –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–∏–¥–µ–ª–∏.
=======
There are many services (and we can build our own) that listen for global errors using `window.onerror`, save errors and provide an interface to access and analyze them. That's great, as we can see real errors, triggered by our users. But if a script comes from another origin, then there's not much information about errors in it, as we've just seen.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–ü–æ—Ö–æ–∂–∞—è –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ (CORS) –≤–Ω–µ–¥—Ä–µ–Ω–∞ –∏ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –¥—Ä—É–≥–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

<<<<<<< HEAD
**–ß—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø, –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–≥—É `<script>` –∞—Ç—Ä–∏–±—É—Ç `crossorigin`, –∏, –∫—Ä–æ–º–µ —Ç–æ–≥–æ, —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏.**
=======
**To allow cross-origin access, the `<script>` tag needs to have the `crossorigin` attribute, plus the remote server must provide special headers.**
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç—Ä–∏ —É—Ä–æ–≤–Ω—è –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

<<<<<<< HEAD
1. **–ê—Ç—Ä–∏–±—É—Ç `crossorigin` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** -- –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω.
2. **`crossorigin="anonymous"`** -- –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Access-Control-Allow-Origin` —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `*` –∏–ª–∏ –Ω–∞—à –¥–æ–º–µ–Ω. –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∫—É–∫–∏ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.
3. **`crossorigin="use-credentials"`** -- –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Access-Control-Allow-Origin` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∞—à –¥–æ–º–µ–Ω –∏ `Access-Control-Allow-Credentials: true`. –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∫—É–∫–∏ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.

```smart
–ü–æ—á–∏—Ç–∞—Ç—å –±–æ–ª—å—à–µ –æ –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–∞—Ö –≤—ã –º–æ–∂–µ—Ç–µ –≤ –≥–ª–∞–≤–µ <info:fetch-crossorigin>. –¢–∞–º –æ–ø–∏—Å–∞–Ω –º–µ—Ç–æ–¥ `fetch` –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–æ –ø–æ–ª–∏—Ç–∏–∫–∞ —Ç–∞–º —Ç–æ—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ.
=======
1. **No `crossorigin` attribute** -- access prohibited.
2. **`crossorigin="anonymous"`** -- access allowed if the server responds with the header `Access-Control-Allow-Origin` with `*` or our origin. Browser does not send authorization information and cookies to remote server.
3. **`crossorigin="use-credentials"`** -- access allowed if the server sends back the header `Access-Control-Allow-Origin` with our origin and `Access-Control-Allow-Credentials: true`. Browser sends authorization information and cookies to remote server.

```smart
You can read more about cross-origin access in the chapter <info:fetch-crossorigin>. It describes the `fetch` method for network requests, but the policy is exactly the same.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

–¢–∞–∫–æ–µ –ø–æ–Ω—è—Ç–∏–µ –∫–∞–∫ "–∫—É–∫–∏" (cookies) –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –≥–ª–∞–≤–µ, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—á–∏—Ç–∞—Ç—å –æ –Ω–∏—Ö –≤ –≥–ª–∞–≤–µ <info:cookie>.
```

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∞—Ç—Ä–∏–±—É—Ç `crossorigin` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª. –ü–æ—ç—Ç–æ–º—É –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –±—ã–ª –∑–∞–ø—Ä–µ—â—ë–Ω. –î–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º –µ–≥–æ.

–ú—ã –º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å `"anonymous"` (–∫—É–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫) –∏–ª–∏ `"use-credentials"` (–∫—É–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–∞) –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞.

<<<<<<< HEAD
–ï—Å–ª–∏ –∫—É–∫–∏ –Ω–∞—Å –Ω–µ –≤–æ–ª–Ω—É—é—Ç, —Ç–æ–≥–¥–∞ —Å–º–µ–ª–æ –≤—ã–±–∏—Ä–∞–µ–º `"anonymous"`:
=======
If we don't care about cookies, then `"anonymous"` is the way to go:
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

```html run height=0
<script>
window.onerror = function(message, url, line, col, errorObj) {
  alert(`${message}\n${url}, ${line}:${col}`);
};
</script>
<script *!*crossorigin="anonymous"*/!* src="https://cors.javascript.info/article/onload-onerror/crossorigin/error.js"></script>
```

<<<<<<< HEAD
–¢–µ–ø–µ—Ä—å –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Access-Control-Allow-Origin`, –≤—Å—ë —Ö–æ—Ä–æ—à–æ. –£ –Ω–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –æ—à–∏–±–∫–∞–º.
=======
Now, assuming that the server provides an `Access-Control-Allow-Origin` header, everything's fine. We have the full error report.
>>>>>>> 4d01fc20d4d82358e61518a31efe80dec9bb2602

## –ò—Ç–æ–≥–æ

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è `<img>`, –≤–Ω–µ—à–Ω–∏–µ —Å—Ç–∏–ª–∏, —Å–∫—Ä–∏–ø—Ç—ã –∏ –¥—Ä—É–≥–∏–µ —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±—ã—Ç–∏—è `load` –∏ `error` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏:

- `load` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ,
- `error` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏.

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ - —ç—Ç–æ `<iframe>`: –ø–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –ø—Ä–∏—á–∏–Ω–∞–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ–≥–¥–∞ `load` –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –∑–∞–≥—Ä—É–∑–∫–∞, –¥–∞–∂–µ –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –±—ã–ª–∞ –Ω–∞–π–¥–µ–Ω–∞.

–°–æ–±—ã—Ç–∏–µ `readystatechange` —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–æ–±—ã—Ç–∏—è `load/error` –ø—Ä–æ—â–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
