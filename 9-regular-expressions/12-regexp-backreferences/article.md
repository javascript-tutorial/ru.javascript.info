# Обратные ссылки в шаблоне: \N и \k<имя>

Доступ к содержимому скобочных групп `pattern:(...)` есть не только в результате поиска и при замене, но и в самом шаблоне.

## Обратная ссылка по номеру: \N

К группе можно обратиться в шаблоне, используя `pattern:\N`, где `N` -- это номер группы.

Чтобы было яснее, зачем это нужно, рассмотрим пример.

Необходимо найти строки в кавычках: либо одинарных `subject:'...'`, либо двойных `subject:"..."` -- оба варианта должны подходить.

Как найти такие строки?

Можно попытаться добавить оба вида кавычек в квадратные скобки: `pattern:['"](.*?)['"]`, но в таком случае будут находиться строки со смешанными кавычками, например `match:"...'` и `match:'..."`. Это приведёт к ошибке, когда одна кавычка окажется внутри других, как в строке `subject:"She's the one!"`:

```js run
let str = `He said: "She's the one!".`;

let regexp = /['"](.*?)['"]/g;

// Результат - не тот, который хотелось бы
alert( str.match(regexp) ); // "She'
```

Как видно, шаблон нашёл открывающую кавычку `match:"`, а после нашёл текст вплоть до следующей кавычки `match:'`, после чего поиск завершился.

Для того, чтобы шаблон искал закрывающую кавычку такую же, как и открывающую, обернём открывающие кавычки в скобочную группу и используем обратную ссылку на неё: `pattern:(['"])(.*?)\1`.

Вот верный код:

```js run
let str = `He said: "She's the one!".`;

*!*
let regexp = /(['"])(.*?)\1/g;
*/!*

alert( str.match(regexp) ); // "She's the one!"
```

Теперь работает! Движок регулярных выражений находит первую кавычку из шаблона `pattern:(['"])` и запоминает её содержимое. Это первая скобочная группа.

Далее в шаблоне `pattern:\1` означает "найти то же самое, что в первой скобочной группе", а именно -- аналогичную кавычку в нашем случае.

Аналогично, `pattern:\2` означает содержимое второй скобочной группы, `pattern:\3` - третьей, и так далее.

```smart
Мы не можем обратиться к группе, которая исключена из запоминания при помощи `pattern:?:`.
```

```warn header="Не перепутайте: в шаблоне `pattern:\1`, при замене `pattern:$1`"
В строке замены для вставки группы мы используем доллар: `pattern:$1`, а в шаблоне обратный слеш `pattern:\1`.
```

## Обратная ссылка по имени: `\k<имя>`

Если в регулярном выражении много скобочных групп, то удобно давать им имена.

Для обращения к именованной группе можно использовать синтаксис `pattern:\k<имя>`.

В примере ниже кавычки обозначены `pattern:?<quote>`, так что обращение будет `pattern:\k<quote>`:

```js run
let str = `He said: "She's the one!".`;

let regexp = /(?<quote>['"])(.*?)\k<quote>/g;

alert( str.match(regexp) ); // "She's the one!"
```
